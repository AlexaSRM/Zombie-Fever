{"version":3,"file":"ace.js","sourceRoot":"","sources":["../../lib/ace.ts"],"names":[],"mappings":"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","sourcesContent":["const cmd = require('commander');\n \nimport { CommandFactory } from './commandFactory';\nimport { ConsoleLogger } from './consoleLogger';\nimport { ConsoleStdOutput } from './consoleStdOutput';\nimport { Utilities } from './utilities';\nimport { crashOnUnhandledRejections } from '@alexa-games/sfb-util';\nimport { ManifestUtils } from './manifestUtils';\n\ncrashOnUnhandledRejections();\n\nconst consoleLogger = new ConsoleLogger();\nconst consoleStdOutput = new ConsoleStdOutput();\nconst commandFactory = new CommandFactory(consoleLogger, consoleStdOutput);\n\n\ncmd\n    .version(ManifestUtils.readPackageVersion(consoleLogger));\n\ncmd\n    .option('-v, --verbose', 'Increase verbose output.')\n\ncmd\n    .command('new <story>')\n    .option('-t, --template [templateName]', \"Template name to use for new skill. Options are 'example_story', 'tutorial', 'adventure', and 'quiz'.\")\n    .description('story - Path to new story. Create a new story project from a template.')\n    .action(async (name: string, options: any) => {\n        await Utilities.wrap(cmd.verbose, () => {\n            const template = options.template || \"example_story\";\n\n            return commandFactory.buildNewProjectCommand(name, { template }).run();\n        },\n        consoleLogger);\n    });\n\ncmd\n    .command('deploy <story>')\n    .description('story - Path to story. Build and deploy a story to developer portal and AWS lambda.')\n    .option('-o, --override', 'Override version check.')\n    .option('-s, --stage [stageName]', 'Stage to deploy (i.e. dev, test, beta, prod)')\n    .option('-l, --locale [localeName]', 'Locale to deploy (i.e. en-us, en-gb, fr-fr, etc.) when using different lambdas for each locale')\n    .action(async (name: string, options: any) => {\n        await Utilities.wrap(cmd.verbose, async () => {\n            const enforceLatest = !options.override;\n\n            if(options.stage) {\n                process.env[\"stage\"] = options.stage;\n            }\n            if(options.locale) {\n                process.env[\"locale\"] = options.locale;\n            }\n\n            await commandFactory.buildImportCommand(name, { enforceLatest }).run();\n            await commandFactory.buildBakeCommand(name).run();\n            await commandFactory.buildStageCommand(name).run();\n            await commandFactory.buildDeployCommand(name).run();\n        },\n        consoleLogger);\n    });\n\ncmd\n    .command('deploy-metadata <story>')\n    .description('story - Path to story. Build and deploy updated metadata (skill manifest and voice model) but do not deploy lambda. Useful when lambda code is large or when uploading lambda through an S3 linked zip file.')\n    .option('-o, --override', 'Override version check.')\n    .option('-s, --stage [stageName]', 'Stage to deploy (i.e. dev, test, beta, prod)')\n    .option('-l, --locale [localeName]', 'Locale to deploy (i.e. en-us, en-gb, fr-fr, etc.) when using different lambdas for each locale')\n    .action(async (name: string, options: any) => {\n        await Utilities.wrap(cmd.verbose, async () => {\n            const enforceLatest = !options.override;\n\n            if(options.stage) {\n                process.env[\"stage\"] = options.stage;\n            }\n            if(options.locale) {\n                process.env[\"locale\"] = options.locale;\n            }\n\n            await commandFactory.buildImportCommand(name, { enforceLatest }).run();\n            await commandFactory.buildBakeCommand(name).run();\n            await commandFactory.buildStageCommand(name).run();\n            await commandFactory.buildDeployMetadataCommand(name).run();\n        },\n        consoleLogger);\n    });\n\ncmd\n    .command('deploy-via-zip <story>')\n    .description('story - Path to story. Build and deploy skill using a zip file transfer to S3/Lambda. Needed when on slow remote connections (because uploading to s3 is faster than aws update-function command) or when exceeding the command line 69905067 byte limit.')\n    .option('-o, --override', 'Override version check.')\n    .option('-s, --stage [stageName]', 'Stage to deploy (i.e. dev, test, beta, prod)')\n    .option('-l, --locale [localeName]', 'Locale to deploy (i.e. en-us, en-gb, fr-fr, etc.) when using different lambdas for each locale')\n    .action(async (name: string, options: any) => {\n        await Utilities.wrap(cmd.verbose, async () => {\n            const enforceLatest = !options.override;\n\n            if(options.stage) {\n                process.env[\"stage\"] = options.stage;\n            }\n            if(options.locale) {\n                process.env[\"locale\"] = options.locale;\n            }\n\n            await commandFactory.buildImportCommand(name, { enforceLatest }).run();\n            await commandFactory.buildBakeCommand(name).run();\n            await commandFactory.buildStageCommand(name).run();\n            await commandFactory.buildDeployMetadataCommand(name).run();\n            await commandFactory.buildUploadZipLambda(name, options.locale).run();\n        },\n        consoleLogger);\n    });\n\ncmd\n    .command('build <story>')\n    .description('story - Path to story. Build a story without deploying.')\n    .option('-o, --override', 'Override version check.')\n    .option('-s, --stage [stageName]', 'Stage to deploy (i.e. dev, test, beta, prod)')\n    .option('-l, --locale [localeName]', 'Locale to deploy (i.e. en-us, en-gb, fr-fr, etc.) when using different lambdas for each locale')\n    .action(async (name: string, options: any) => {\n        await Utilities.wrap(cmd.verbose, async () => {\n            const enforceLatest = !options.override;\n\n            if(options.stage) {\n                process.env[\"stage\"] = options.stage;\n            }\n            if(options.locale) {\n                process.env[\"locale\"] = options.locale;\n            }\n\n            await commandFactory.buildImportCommand(name, { enforceLatest }).run();\n            await commandFactory.buildBakeCommand(name).run();\n            await commandFactory.buildStageCommand(name).run();\n        },\n        consoleLogger);\n    });\n\ncmd\n    .command('simulate <story>')\n    .option('-l, --locale [locale]', 'Set Locale to Simulate')\n    .option('-o, --override', 'Override version check')\n    .option('-q, --quiet', 'Quiet mode')\n    .description('story - Path to story. Simulate a story.')\n    .action(async (name: string, options: any) => {\n        await Utilities.wrap(cmd.verbose, async () => {\n            const locale = options.locale || \"en-US\";\n            const quiet = !!options.quiet;\n            const enforceLatest = !options.override;\n\n            await commandFactory.buildImportCommand(name, { enforceLatest }).run();\n            await commandFactory.buildBakeCommand(name).run();\n            await commandFactory.buildSimulateCommand(name, { locale, quiet }).run();\n        },\n        consoleLogger);\n    });\n\n/*\ncmd\n    .command('test <story>')\n    .option('-l, --locale [locale]', 'Set Locale to Simulate')\n    .option('-o, --override', 'Override version check')\n    .description('story - Path to story. Simulate a story.')\n    .action(async (name: string, options: any) => {\n        await Utilities.wrap(cmd.verbose, async () => {\n            const locale = options.locale || \"en-US\";\n            const enforceLatest = !options.override;\n\n            await commandFactory.buildImportCommand(name, { enforceLatest }).run();\n            await commandFactory.buildBakeCommand(name).run();\n            await commandFactory.buildTestCommand(name, { locale }).run();\n        },\n        consoleLogger);\n    });\n*/\ncmd\n    .command('clean <story>')\n    .description('story - Clean out the .deploy, code .dist folder, and any extra node_modules folders for the given story. Run clean when initially creating a new stage/locale to force the creation of a new skill id.')\n    .action(async (name: string, options: any) => {\n        await Utilities.wrap(cmd.verbose, async () => {\n            await commandFactory.buildCleanCommand(name).run();\n        },\n        consoleLogger);\n    });\n\ncmd\n    .command('upload <story>')\n    .description('story - Path to story. Upload public resources to S3.')\n    .action(async (name: string, options: any) => {\n        await Utilities.wrap(cmd.verbose, async () => {\n            await commandFactory.buildUploadResourcesCommand(name).run();\n        },\n        consoleLogger);\n    });\n\n\ncmd\n    .command('vscode')\n    .description('Install vscode extension for SFB editor support.')\n    .action(async () => {\n        await Utilities.wrap(cmd.verbose, async () => {\n            await commandFactory.buildVscodeExtensionCommand().run();\n        },\n        consoleLogger);\n    });\n\n// error on unknown commands\ncmd.on('command:*', function () {\n    console.error('Invalid command: %s\\nSee --help for a list of available commands.', cmd.args.join(' '));\n    process.exit(1);\n});\n\ncmd\n    .parse(process.argv);\n\nif (process.argv.length === 2) {\n    cmd.help();\n}\n"]}