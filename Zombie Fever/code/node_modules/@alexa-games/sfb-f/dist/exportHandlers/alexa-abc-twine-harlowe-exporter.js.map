{"version":3,"file":"alexa-abc-twine-harlowe-exporter.js","sourceRoot":"","sources":["../../exportHandlers/alexa-abc-twine-harlowe-exporter.ts"],"names":[],"mappings":";;AAEA,MAAa,2BAA2B;IAG7B,UAAU,CAAC,YAAkB,EAAE,kBAAwB;QAE1D,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;QAE1B,IAAI,SAAS,GAAG,EAAE,CAAC;QAEnB,IAAI,KAAK,GAAG,YAAY,CAAC,KAAK,CAAC;QAE/B,oCAAoC;QACpC;;;;;;;UAOE;QAEF,SAAS,IAAI,uBAAuB,KAAK,6KAA6K,CAAC;QAEvN,IAAI,GAAG,GAAG,CAAC,CAAC;QAEZ,IAAI,OAAO,GAAG,CAAC,CAAC;QAChB,IAAI,KAAK,GAAG,EAAE,CAAC;QAEf,IAAI,IAAI,GAAG,GAAG,CAAC;QAEf,IAAI,IAAI,GAAG,GAAG,CAAC;QAEf,KAAI,IAAI,IAAI,IAAI,YAAY,CAAC,KAAK,EAAE;YAEhC,IAAI,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC;YAEnB,IAAI,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;YAEpC,WAAW,IAAI,MAAM,CAAC;YAEtB,IAAG,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;gBAChB,WAAW,IAAI,aAAa,CAAC;gBAC7B,WAAW,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;gBAC/B,WAAW,IAAI,MAAM,CAAC;aACzB;YAED,IAAG,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;gBAChB,WAAW,IAAI,aAAa,CAAC;gBAC7B,WAAW,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;gBAC/B,WAAW,IAAI,MAAM,CAAC;aACzB;YAED,IAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBACjB,WAAW,IAAI,cAAc,CAAC;gBAC9B,WAAW,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;gBAChC,WAAW,IAAI,MAAM,CAAC;aACzB;YAED,IAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;gBACnB,WAAW,IAAI,gBAAgB,CAAC;gBAChC,WAAW,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC;gBAClC,WAAW,IAAI,MAAM,CAAC;aACzB;YAED,IAAG,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;gBAChB,WAAW,IAAI,aAAa,CAAC;gBAC7B,WAAW,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;gBAC/B,WAAW,IAAI,MAAM,CAAC;aACzB;YAED,IAAG,IAAI,CAAC,MAAM,CAAC,OAAO,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;gBACtD,WAAW,IAAI,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC;gBAC/C,WAAW,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;gBACnC,WAAW,IAAI,MAAM,CAAC;aACzB;YAED,SAAS,IAAI,wBAAwB,GAAG,WAAW,IAAI,uBAAuB,IAAI,IAAI,IAAI,oBAAoB,WAAW,qBAAqB,CAAS;YAEvJ,GAAG,EAAE,CAAC;YAEN,OAAO,EAAE,CAAC;YACV,IAAG,OAAO,IAAI,KAAK,EAAE;gBACjB,OAAO,GAAG,CAAC,CAAC;gBACZ,IAAI,IAAI,GAAG,CAAC;aACf;YAED,IAAI,GAAG,OAAO,GAAG,GAAG,CAAC;SACxB;QAED,SAAS,IAAI,qBAAqB,CAAC;QAGnC,IAAG,kBAAkB,EAAE;YACnB,kBAAkB,CAAC,SAAS,CAAC,CAAC;YAC9B,OAAO;SACV;IACL,CAAC;CACJ;AAjGD,kEAiGC","sourcesContent":["import { ABCExporter } from '../exportHandlers/exporter';\n\nexport class AlexaABCTwineHarlowExporter implements ABCExporter\n{\t\n\n    public exportData(jsonInputObj : any, exportDataCallback : any) {\n\n        console.log(jsonInputObj);\n\n        let twineData = \"\";\n\n        let title = jsonInputObj.title;\n\n        // Twine output data looks like this\n        /*\n        <tw-storydata name=\"Journey Under the Sea\" startnode=\"1\" creator=\"Twine\" creator-version=\"2.2.1\" ifid=\"2B4BC8EA-D9FD-4C1B-A6E5-EB7470E3285D\" zoom=\"1\" format=\"Harlowe\" format-version=\"2.1.0\" options=\"\" hidden><style role=\"stylesheet\" id=\"twine-user-stylesheet\" type=\"text/twine-css\"></style>\n        <script role=\"script\" id=\"twine-user-script\" type=\"text/twine-javascript\">Hello World</script>\n        <tw-passagedata pid=\"1\" name=\"Welcome\" tags=\"\" position=\"463,58\" size=\"100,100\">Welcome to the game, do you go [[left]] or [[right]]?</tw-passagedata>\n        <tw-passagedata pid=\"2\" name=\"left\" tags=\"\" position=\"277,187\" size=\"100,100\">You are underwater, do you [[swim]] or [[drown]] or [[up]]?</tw-passagedata>\n        <tw-passagedata pid=\"3\" name=\"right\" tags=\"\" position=\"905,225\" size=\"100,100\">Double-click this passage to edit it.</tw-passagedata>\n        </tw-storydata>\n        */\n\n        twineData += `<tw-storydata name=\"${title}\" startnode=\"1\" creator=\"Twine\" creator-version=\"2.2.1\" ifid=\"2B4BC8EA-D9FD-4C1B-A6E5-EB7470E3285D\" zoom=\"1\" format=\"Harlowe\" format-version=\"2.1.0\" options=\"\" hidden>\\n\\n`;\n\n        let pid = 1;\n\n        let currCol = 0;\n        let xCols = 20;\n\n        let xPos = 100;\n\n        let yPos = 100;\n\n        for(let node of jsonInputObj.nodes) {\n\n            let name = node.id;\n\n            let bodyContent = node.body.content;\n\n            bodyContent += \"\\n\\n\";\n\n            if(node.body.recap) {\n                bodyContent += \"##Recap\\n\\n\";\n                bodyContent += node.body.recap;    \n                bodyContent += \"\\n\\n\";\n            }\n\n            if(node.body.voice) {\n                bodyContent += \"##Voice\\n\\n\";\n                bodyContent += node.body.voice;    \n                bodyContent += \"\\n\\n\";\n            }\n\n            if(node.body.effect) {\n                bodyContent += \"##Effect\\n\\n\";\n                bodyContent += node.body.effect;    \n                bodyContent += \"\\n\\n\";\n            }\n\n            if(node.body.ambiance) {\n                bodyContent += \"##Ambiance\\n\\n\";\n                bodyContent += node.body.ambiance;    \n                bodyContent += \"\\n\\n\";\n            }\n\n            if(node.body.image) {\n                bodyContent += \"##Image\\n\\n\";\n                bodyContent += node.body.image;    \n                bodyContent += \"\\n\\n\";\n            }\n        \n            if(node.action.targets && node.action.targets.length > 0) {\n                bodyContent += \"#\" + node.action.type + \"\\n\\n\";\n                bodyContent += node.action.content;\n                bodyContent += \"\\n\\n\";\n            }\n\n            twineData += `<tw-passagedata pid=\"${pid}\" name=\"${name}\" tags=\"\" position=\"${xPos},${yPos}\" size=\"100,100\">${bodyContent}</tw-passagedata>\\n`        ;\n\n            pid++;\n\n            currCol++;\n            if(currCol >= xCols) {\n                currCol = 0;\n                yPos += 200;\n            }\n\n            xPos = currCol * 200;\n        }\n\n        twineData += `</tw-storydata>\\n\\n`;\n\n\n        if(exportDataCallback) {\n            exportDataCallback(twineData);\n            return;\n        }\n    }\n}\n\n\n"]}